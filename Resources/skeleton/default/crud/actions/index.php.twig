
    /**
     * Lists all {{ entity }} entities.
     *
{% if 'annotation' == format %}
     * @Route("", name="{{ route_name_prefix }}")
     * @Security("has_role('ROLE_{{ entity|upper }}_LIST')")
     * @Template()
{% endif %}
     */
    public function indexAction()
    {
{% if 'annotation' != format %}
        if (!$this->isGranted('ROLE_{{ entity|upper }}_LIST')) {
            throw new AccessDeniedException();
        }
{% endif %}
        $this->setPage($this->getRequestParameter('page', $this->getPage()));
        $pager = $this->getPager();
        if ($this->isXmlHttpRequest()) {
            return $this->render('{{ bundle }}:{{ entity|replace({'\\': '/'}) }}CRUD:list.html.twig', [
                'pager' => $pager,
                'sort'  => $this->getSort(),
            ]);
        }
        $filter_form = $this->getFilterForm();

{% if 'annotation' == format %}
        return [
            'pager'  => $pager,
            'filter' => $filter_form->createView(),
            'sort'   => $this->getSort(),
        ];
{% else %}
        return $this->render('{{ bundle }}:{{ entity|replace({'\\': '/'}) }}CRUD:index.html.twig', [
            'pager'  => $pager,
            'filter' => $filter_form->createView(),
            'sort'   => $this->getSort(),
        ]);
{% endif %}
    }

    /**
     * Filter {{ entity }} entities.
     *
{% if 'annotation' == format %}
     * @Route("/filter", name="{{ route_name_prefix }}_filter")
     * @Security("has_role('ROLE_{{ entity|upper }}_LIST')")
     * @Method("POST")
{% endif %}
     */
    public function filterAction(Request $request)
    {
{% if 'annotation' != format %}
        if (!$this->isGranted('ROLE_{{ entity|upper }}_LIST')) {
            throw new AccessDeniedException();
        }
        if ($this->getRequest()->getMethod() == 'POST')
            throw $this->createNotFoundException();
{% endif %}
        if ($request->get('action_reset')) {
            $this->setFilters([]);

            return $this->redirectToRoute('{{ route_name_prefix }}');
        }
        $filter_form = $this->getFilterForm();
        $filter_form->handleRequest($request);
        if ($filter_form->isValid()) {
            $this->setPage(1);
            $this->setFilters($filter_form->getData());

            return $this->redirectToRoute('{{ route_name_prefix }}');
        }

        return $this->render('{{ bundle }}:{{ entity }}CRUD:index.html.twig', [
            'filter' => $filter_form->createView(),
            'pager'  => $this->getPager(),
            'sort'   => $this->getSort(),
        ]);
    }
